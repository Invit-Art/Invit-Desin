{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{collection,onSnapshot,deleteDoc,doc}from\"firebase/firestore\";import{db}from\"../Database/firebaseConfig\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MostrarInvitaciones=_ref=>{let{CATEGORIA_EVENTO,NOMBRE_CLIENTE,setListaInvitaciones}=_ref;const[invitaciones,setInvitaciones]=useState([]);useEffect(()=>{if(!CATEGORIA_EVENTO||!NOMBRE_CLIENTE){console.warn(\"‚ö†Ô∏è `CATEGORIA_EVENTO` o `NOMBRE_CLIENTE` est√°n vac√≠os. No se puede obtener invitaciones.\");return;}const invitacionesRef=collection(db,CATEGORIA_EVENTO,NOMBRE_CLIENTE,\"invitaciones\");// ‚úÖ Escuchar cambios en tiempo real con `onSnapshot()`\nconst unsubscribe=onSnapshot(invitacionesRef,querySnapshot=>{const data=querySnapshot.docs.map(doc=>({id:doc.id,...doc.data()}));console.log(`‚úÖ Invitaciones actualizadas en tiempo real para ${CATEGORIA_EVENTO} - ${NOMBRE_CLIENTE}:`,data);setInvitaciones(data);setListaInvitaciones&&setListaInvitaciones(data);});// üìå Limpiar suscripci√≥n al desmontar el componente\nreturn()=>unsubscribe();},[CATEGORIA_EVENTO,NOMBRE_CLIENTE]);const eliminarInvitacion=async id=>{if(!CATEGORIA_EVENTO||!NOMBRE_CLIENTE){console.error(\"‚ö†Ô∏è No se puede eliminar una invitaci√≥n sin un evento definido.\");return;}try{const idNormalizado=id.replace(/\\s+/g,\"\").toLowerCase();const docRef=doc(db,CATEGORIA_EVENTO,NOMBRE_CLIENTE,\"invitaciones\",idNormalizado);await deleteDoc(docRef);console.log(`‚úÖ Invitaci√≥n con ID ${idNormalizado} eliminada correctamente.`);// üìå Ya no es necesario actualizar manualmente el estado, `onSnapshot()` lo hace autom√°ticamente\n}catch(error){console.error(\"‚ùå Error al eliminar la invitaci√≥n:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Numero Total de invitados:\"}),/*#__PURE__*/_jsxs(\"table\",{border:\"1\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Invitados Ni\\xF1os\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Invitados Adultos\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total Invitados\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+(invitacion.invitadosNi√±os||0),0)}),/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+(invitacion.invitadosAdultos||0),0)}),/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+((invitacion.invitadosNi√±os||0)+(invitacion.invitadosAdultos||0)),0)})]})})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Lista de Invitaciones Guardadas\"}),!CATEGORIA_EVENTO||!NOMBRE_CLIENTE?/*#__PURE__*/_jsx(\"p\",{children:\"\\u26A0\\uFE0F No hay un evento definido para mostrar las invitaciones.\"}):/*#__PURE__*/_jsxs(\"table\",{border:\"1\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Adultos\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ni\\xF1os\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Enlace\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:invitaciones.length>0?invitaciones.map(invitacion=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:invitacion.nombre}),/*#__PURE__*/_jsx(\"td\",{children:invitacion.invitadosAdultos}),/*#__PURE__*/_jsx(\"td\",{children:invitacion.invitadosNi√±os}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"a\",{href:invitacion.link,target:\"_blank\",rel:\"noopener noreferrer\",children:\"Ver Invitaci\\xF3n\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarInvitacion(invitacion.id),children:\"\\u274C Eliminar\"})})]},invitacion.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",children:\"No hay invitaciones registradas a\\xFAn.\"})})})]})]});};export default MostrarInvitaciones;","map":{"version":3,"names":["React","useState","useEffect","collection","onSnapshot","deleteDoc","doc","db","jsx","_jsx","jsxs","_jsxs","MostrarInvitaciones","_ref","CATEGORIA_EVENTO","NOMBRE_CLIENTE","setListaInvitaciones","invitaciones","setInvitaciones","console","warn","invitacionesRef","unsubscribe","querySnapshot","data","docs","map","id","log","eliminarInvitacion","error","idNormalizado","replace","toLowerCase","docRef","children","border","reduce","total","invitacion","invitadosNi√±os","invitadosAdultos","length","nombre","href","link","target","rel","onClick","colSpan"],"sources":["D:/invit-desin/src/Database/MostrarInvitaciones.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { collection, onSnapshot, deleteDoc, doc } from \"firebase/firestore\";\r\nimport { db } from \"../Database/firebaseConfig\";\r\n\r\nconst MostrarInvitaciones = ({ CATEGORIA_EVENTO, NOMBRE_CLIENTE, setListaInvitaciones }) => {\r\n  const [invitaciones, setInvitaciones] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!CATEGORIA_EVENTO || !NOMBRE_CLIENTE) {\r\n      console.warn(\"‚ö†Ô∏è `CATEGORIA_EVENTO` o `NOMBRE_CLIENTE` est√°n vac√≠os. No se puede obtener invitaciones.\");\r\n      return;\r\n    }\r\n\r\n    const invitacionesRef = collection(db, CATEGORIA_EVENTO, NOMBRE_CLIENTE, \"invitaciones\");\r\n\r\n    // ‚úÖ Escuchar cambios en tiempo real con `onSnapshot()`\r\n    const unsubscribe = onSnapshot(invitacionesRef, (querySnapshot) => {\r\n      const data = querySnapshot.docs.map(doc => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n\r\n      console.log(`‚úÖ Invitaciones actualizadas en tiempo real para ${CATEGORIA_EVENTO} - ${NOMBRE_CLIENTE}:`, data);\r\n      setInvitaciones(data);\r\n      setListaInvitaciones && setListaInvitaciones(data);\r\n    });\r\n\r\n    // üìå Limpiar suscripci√≥n al desmontar el componente\r\n    return () => unsubscribe();\r\n  }, [CATEGORIA_EVENTO, NOMBRE_CLIENTE]);\r\n\r\n  const eliminarInvitacion = async (id) => {\r\n    if (!CATEGORIA_EVENTO || !NOMBRE_CLIENTE) {\r\n      console.error(\"‚ö†Ô∏è No se puede eliminar una invitaci√≥n sin un evento definido.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const idNormalizado = id.replace(/\\s+/g, \"\").toLowerCase();\r\n      const docRef = doc(db, CATEGORIA_EVENTO, NOMBRE_CLIENTE, \"invitaciones\", idNormalizado);\r\n      \r\n      await deleteDoc(docRef);\r\n      console.log(`‚úÖ Invitaci√≥n con ID ${idNormalizado} eliminada correctamente.`);\r\n      \r\n      // üìå Ya no es necesario actualizar manualmente el estado, `onSnapshot()` lo hace autom√°ticamente\r\n    } catch (error) {\r\n      console.error(\"‚ùå Error al eliminar la invitaci√≥n:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Numero Total de invitados:</h2>\r\n\r\n      {/* Tabla con los Totales de Invitados */}\r\n      <table border=\"1\">\r\n        <thead>\r\n          <tr>\r\n            <th>Invitados Ni√±os</th>\r\n            <th>Invitados Adultos</th>\r\n            <th>Total Invitados</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + (invitacion.invitadosNi√±os || 0), 0)}</td>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + (invitacion.invitadosAdultos || 0), 0)}</td>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + ((invitacion.invitadosNi√±os || 0) + (invitacion.invitadosAdultos || 0)), 0)}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <h2>Lista de Invitaciones Guardadas</h2>\r\n      {!CATEGORIA_EVENTO || !NOMBRE_CLIENTE ? (\r\n        <p>‚ö†Ô∏è No hay un evento definido para mostrar las invitaciones.</p>\r\n      ) : (\r\n        <table border=\"1\">\r\n          <thead>\r\n            <tr>\r\n              <th>Nombre</th>\r\n              <th>Adultos</th>\r\n              <th>Ni√±os</th>\r\n              <th>Enlace</th>\r\n              <th>Acciones</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {invitaciones.length > 0 ? (\r\n              invitaciones.map((invitacion) => (\r\n                <tr key={invitacion.id}>\r\n                  <td>{invitacion.nombre}</td>\r\n                  <td>{invitacion.invitadosAdultos}</td>\r\n                  <td>{invitacion.invitadosNi√±os}</td>\r\n                  <td><a href={invitacion.link} target=\"_blank\" rel=\"noopener noreferrer\">Ver Invitaci√≥n</a></td>\r\n                  <td><button onClick={() => eliminarInvitacion(invitacion.id)}>‚ùå Eliminar</button></td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td colSpan=\"5\">No hay invitaciones registradas a√∫n.</td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MostrarInvitaciones;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}