{"ast":null,"code":"import React,{useState}from\"react\";import{db}from\"./firebaseConfig\";import imagenes from\"../assets/imagenes\";import{collection,doc,getDocs,setDoc}from\"firebase/firestore\";import{signInWithEmailAndPassword,signOut,createUserWithEmailAndPassword}from\"firebase/auth\";import{auth}from\"./firebaseConfig\";import\"./Login.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=_ref=>{let{onLogin,setVerificandoSesion,setUsuarioActual}=_ref;const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[mostrarPassword,setMostrarPassword]=useState(false);// ✅ Buscar ruta personalizada en Firestore\nconst obtenerRutaPersonalizada=async email=>{const categorias=[\"XV Años\",\"Eventos Empresariales\",\"Bodas\"];// o hazlo dinámico\nfor(const categoria of categorias){const clientesRef=collection(db,\"Clientes\",\"Categorias\",categoria);const snapshot=await getDocs(clientesRef);for(const docSnap of snapshot.docs){const data=docSnap.data();if(data.correo===email){return data.rutaPersonalizada;}}}throw new Error(\"Cliente no registrado en Firestore.\");};const handleLogin=async()=>{try{setVerificandoSesion(true);// ✅ Activa el estado de carga\nconst userCred=await signInWithEmailAndPassword(auth,email,password);const user=userCred.user;const ruta=await obtenerRutaPersonalizada(user.email);setUsuarioActual(user);// ✅ Actualiza el estado\nonLogin(user);// ✅ Notifica al padre si es necesario\nsetVerificandoSesion(false);// ✅ Apaga la pantalla de carga\nwindow.location.href=ruta;// 🔀 Redirige al usuario\n}catch(err){alert(\"❌ El correo o contraseña son incorrectos: \");setVerificandoSesion(false);// ❌ Evita que se quede en modo cargando\n}};const handleLogout=()=>{signOut(auth).then(()=>{alert(\"👋 Sesión cerrada\");onLogin(null);});};return/*#__PURE__*/_jsx(\"div\",{className:\"fondo-login\",children:/*#__PURE__*/_jsx(\"div\",{className:\"wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();handleLogin();},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Iniciar sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Correo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-field password-field\",children:[/*#__PURE__*/_jsx(\"input\",{type:mostrarPassword?\"text\":\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"span\",{className:\"toggle-password\",onClick:()=>setMostrarPassword(prev=>!prev),children:/*#__PURE__*/_jsx(\"i\",{className:`fa-solid ${mostrarPassword?\"fa-eye\":\"fa-eye-slash\"}`})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"forget\",children:/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"\\xBFOlvidaste tu contrase\\xF1a?\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"login\",type:\"submit\",onClick:handleLogin,children:\"Iniciar sesi\\xF3n\"})]})})});};export default Login;","map":{"version":3,"names":["React","useState","db","imagenes","collection","doc","getDocs","setDoc","signInWithEmailAndPassword","signOut","createUserWithEmailAndPassword","auth","jsx","_jsx","jsxs","_jsxs","Login","_ref","onLogin","setVerificandoSesion","setUsuarioActual","email","setEmail","password","setPassword","mostrarPassword","setMostrarPassword","obtenerRutaPersonalizada","categorias","categoria","clientesRef","snapshot","docSnap","docs","data","correo","rutaPersonalizada","Error","handleLogin","userCred","user","ruta","window","location","href","err","alert","handleLogout","then","className","children","onSubmit","e","preventDefault","type","value","onChange","target","required","onClick","prev"],"sources":["D:/invit-desin/src/Database/Login.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { db } from \"./firebaseConfig\";\r\n\r\nimport imagenes from \"../assets/imagenes\";\r\nimport { collection, doc, getDocs, setDoc } from \"firebase/firestore\";\r\nimport { signInWithEmailAndPassword, signOut, createUserWithEmailAndPassword } from \"firebase/auth\";\r\nimport { auth } from \"./firebaseConfig\";\r\nimport \"./Login.css\"\r\n\r\nconst Login = ({ onLogin, setVerificandoSesion, setUsuarioActual }) => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [mostrarPassword, setMostrarPassword] = useState(false);\r\n  \r\n\r\n  // ✅ Buscar ruta personalizada en Firestore\r\n  const obtenerRutaPersonalizada = async (email) => {\r\n    const categorias = [\"XV Años\", \"Eventos Empresariales\", \"Bodas\"]; // o hazlo dinámico\r\n\r\n    for (const categoria of categorias) {\r\n        const clientesRef = collection(db, \"Clientes\", \"Categorias\", categoria);\r\n        const snapshot = await getDocs(clientesRef);\r\n\r\n        for (const docSnap of snapshot.docs) {\r\n        const data = docSnap.data();\r\n        if (data.correo === email) {\r\n            return data.rutaPersonalizada;\r\n        }\r\n        }\r\n    }\r\n\r\n    throw new Error(\"Cliente no registrado en Firestore.\");\r\n  };\r\n\r\n  const handleLogin = async () => {\r\n  try {\r\n    setVerificandoSesion(true); // ✅ Activa el estado de carga\r\n\r\n    const userCred = await signInWithEmailAndPassword(auth, email, password);\r\n    const user = userCred.user;\r\n    const ruta = await obtenerRutaPersonalizada(user.email);\r\n\r\n    setUsuarioActual(user);       // ✅ Actualiza el estado\r\n    onLogin(user);                // ✅ Notifica al padre si es necesario\r\n    setVerificandoSesion(false); // ✅ Apaga la pantalla de carga\r\n\r\n    window.location.href = ruta; // 🔀 Redirige al usuario\r\n  } catch (err) {\r\n    alert(\"❌ El correo o contraseña son incorrectos: \");\r\n    setVerificandoSesion(false); // ❌ Evita que se quede en modo cargando\r\n  }\r\n};\r\n\r\n\r\n  const handleLogout = () => {\r\n    signOut(auth).then(() => {\r\n      alert(\"👋 Sesión cerrada\");\r\n      onLogin(null);\r\n    });\r\n  };\r\n\r\n  return (\r\n  <div className=\"fondo-login\">\r\n    <div className=\"wrapper\">\r\n      <form onSubmit={(e) => {\r\n          e.preventDefault();\r\n          handleLogin();\r\n        }}>\r\n        <h2>Iniciar sesión</h2>\r\n\r\n        <div className=\"input-field\">\r\n          <input\r\n            type=\"email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n          />\r\n          <label>Correo</label>\r\n        </div>\r\n\r\n        {/* Campo de contraseña con ícono en esquina */}\r\n        <div className=\"input-field password-field\">\r\n          <input\r\n            type={mostrarPassword ? \"text\" : \"password\"}\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            required\r\n          />\r\n          <label>Contraseña</label>\r\n          <span\r\n            className=\"toggle-password\"\r\n            onClick={() => setMostrarPassword((prev) => !prev)}\r\n          >\r\n            <i className={`fa-solid ${mostrarPassword ? \"fa-eye\" : \"fa-eye-slash\"}`}></i>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"forget\">\r\n          <a href=\"#\">¿Olvidaste tu contraseña?</a>\r\n        </div>\r\n\r\n        <button className=\"login\" type=\"submit\" onClick={handleLogin}>\r\n          Iniciar sesión\r\n        </button>\r\n      </form>\r\n    </div>\r\n  </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}