{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{collection,onSnapshot,deleteDoc,doc}from\"firebase/firestore\";import{db}from\"../Database/firebaseConfig\";import{compartirPorWhatsApp,copiarAlPortapapeles}from\"../componentes/component\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MostrarInvitaciones=_ref=>{let{CATEGORIA_EVENTO,NOMBRE_CLIENTE,setListaInvitaciones,setLinkPrevisualizacion}=_ref;const[invitaciones,setInvitaciones]=useState([]);useEffect(()=>{if(!CATEGORIA_EVENTO||!NOMBRE_CLIENTE){console.warn(\"‚ö†Ô∏è `CATEGORIA_EVENTO` o `NOMBRE_CLIENTE` est√°n vac√≠os. No se puede obtener invitaciones.\");return;}const invitacionesRef=collection(db,CATEGORIA_EVENTO,NOMBRE_CLIENTE,\"invitaciones\");// ‚úÖ Escuchar cambios en tiempo real con `onSnapshot()`\nconst unsubscribe=onSnapshot(invitacionesRef,querySnapshot=>{const data=querySnapshot.docs.map(doc=>({id:doc.id,...doc.data()}));console.log(`‚úÖ Invitaciones actualizadas en tiempo real para ${CATEGORIA_EVENTO} - ${NOMBRE_CLIENTE}:`,data);setInvitaciones(data);setListaInvitaciones&&setListaInvitaciones(data);});// üìå Limpiar suscripci√≥n al desmontar el componente\nreturn()=>unsubscribe();},[CATEGORIA_EVENTO,NOMBRE_CLIENTE]);const compartirInvitacion=(link,nombre)=>{const mensaje=`¬°Hola! Te comparto tu invitaci√≥n personalizada: ${link}`;const whatsappURL=`https://api.whatsapp.com/send?text=${encodeURIComponent(mensaje)}`;window.open(whatsappURL,\"_blank\");};const copiarAlPortapapeles=link=>{navigator.clipboard.writeText(link);alert(\"‚úÖ Enlace copiado al portapapeles.\");};const eliminarInvitacion=async id=>{if(!CATEGORIA_EVENTO||!NOMBRE_CLIENTE){console.error(\"‚ö†Ô∏è No se puede eliminar una invitaci√≥n sin un evento definido.\");return;}try{const idNormalizado=id.replace(/\\s+/g,\"\").toLowerCase();const docRef=doc(db,CATEGORIA_EVENTO,NOMBRE_CLIENTE,\"invitaciones\",idNormalizado);await deleteDoc(docRef);console.log(`‚úÖ Invitaci√≥n con ID ${idNormalizado} eliminada correctamente.`);// üìå Ya no es necesario actualizar manualmente el estado, `onSnapshot()` lo hace autom√°ticamente\n}catch(error){console.error(\"‚ùå Error al eliminar la invitaci√≥n:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"desing-table\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"table\",children:\"Numero Total de invitados:\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"tabla-invitaciones\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Invitados Ni\\xF1os\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Invitados Adultos\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Total Invitados\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+(invitacion.invitadosNi√±os||0),0)}),/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+(invitacion.invitadosAdultos||0),0)}),/*#__PURE__*/_jsx(\"td\",{children:invitaciones.reduce((total,invitacion)=>total+((invitacion.invitadosNi√±os||0)+(invitacion.invitadosAdultos||0)),0)})]})})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"table\",children:\"Lista de Invitaciones Guardadas\"}),!CATEGORIA_EVENTO||!NOMBRE_CLIENTE?/*#__PURE__*/_jsx(\"p\",{children:\"\\u26A0\\uFE0F No hay un evento definido para mostrar las invitaciones.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"tabla-invitaciones2\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nombre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Adultos\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ni\\xF1os\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Enlace\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Acciones\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Compartir\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:invitaciones.length>0?invitaciones.map(invitacion=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:invitacion.nombre}),/*#__PURE__*/_jsx(\"td\",{children:invitacion.invitadosAdultos}),/*#__PURE__*/_jsx(\"td\",{children:invitacion.invitadosNi√±os}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setLinkPrevisualizacion(invitacion.link),children:\"\\uD83D\\uDC41\\uFE0F Ver Invitaci\\xF3n\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarInvitacion(invitacion.id),children:\"\\u274C Eliminar\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>compartirPorWhatsApp(invitacion.link,invitacion.nombre),children:\"\\uD83D\\uDCF1 Compartir\"})})]},invitacion.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",children:\"No hay invitaciones registradas a\\xFAn.\"})})})]})]});};export default MostrarInvitaciones;","map":{"version":3,"names":["React","useState","useEffect","collection","onSnapshot","deleteDoc","doc","db","compartirPorWhatsApp","copiarAlPortapapeles","jsx","_jsx","jsxs","_jsxs","MostrarInvitaciones","_ref","CATEGORIA_EVENTO","NOMBRE_CLIENTE","setListaInvitaciones","setLinkPrevisualizacion","invitaciones","setInvitaciones","console","warn","invitacionesRef","unsubscribe","querySnapshot","data","docs","map","id","log","compartirInvitacion","link","nombre","mensaje","whatsappURL","encodeURIComponent","window","open","navigator","clipboard","writeText","alert","eliminarInvitacion","error","idNormalizado","replace","toLowerCase","docRef","className","children","reduce","total","invitacion","invitadosNi√±os","invitadosAdultos","length","onClick","colSpan"],"sources":["D:/invit-desin/src/Database/MostrarInvitaciones.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { collection, onSnapshot, deleteDoc, doc } from \"firebase/firestore\";\r\nimport { db } from \"../Database/firebaseConfig\";\r\nimport { compartirPorWhatsApp, copiarAlPortapapeles } from \"../componentes/component\";\r\n\r\n\r\nconst MostrarInvitaciones = ({ CATEGORIA_EVENTO, NOMBRE_CLIENTE, setListaInvitaciones, setLinkPrevisualizacion }) => {\r\n\r\n  const [invitaciones, setInvitaciones] = useState([]);\r\n\r\n\r\n  useEffect(() => {\r\n    if (!CATEGORIA_EVENTO || !NOMBRE_CLIENTE) {\r\n      console.warn(\"‚ö†Ô∏è `CATEGORIA_EVENTO` o `NOMBRE_CLIENTE` est√°n vac√≠os. No se puede obtener invitaciones.\");\r\n      return;\r\n    }\r\n\r\n    const invitacionesRef = collection(db, CATEGORIA_EVENTO, NOMBRE_CLIENTE, \"invitaciones\");\r\n\r\n    // ‚úÖ Escuchar cambios en tiempo real con `onSnapshot()`\r\n    const unsubscribe = onSnapshot(invitacionesRef, (querySnapshot) => {\r\n      const data = querySnapshot.docs.map(doc => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n\r\n      console.log(`‚úÖ Invitaciones actualizadas en tiempo real para ${CATEGORIA_EVENTO} - ${NOMBRE_CLIENTE}:`, data);\r\n      setInvitaciones(data);\r\n      setListaInvitaciones && setListaInvitaciones(data);\r\n    });\r\n\r\n    // üìå Limpiar suscripci√≥n al desmontar el componente\r\n    return () => unsubscribe();\r\n  }, [CATEGORIA_EVENTO, NOMBRE_CLIENTE]);\r\n\r\n\r\n  const compartirInvitacion = (link, nombre) => {\r\n    const mensaje = `¬°Hola! Te comparto tu invitaci√≥n personalizada: ${link}`;\r\n    const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(mensaje)}`;\r\n    window.open(whatsappURL, \"_blank\");\r\n  };\r\n\r\n  const copiarAlPortapapeles = (link) => {\r\n    navigator.clipboard.writeText(link);\r\n    alert(\"‚úÖ Enlace copiado al portapapeles.\");\r\n  };\r\n\r\n\r\n  const eliminarInvitacion = async (id) => {\r\n    if (!CATEGORIA_EVENTO || !NOMBRE_CLIENTE) {\r\n      console.error(\"‚ö†Ô∏è No se puede eliminar una invitaci√≥n sin un evento definido.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const idNormalizado = id.replace(/\\s+/g, \"\").toLowerCase();\r\n      const docRef = doc(db, CATEGORIA_EVENTO, NOMBRE_CLIENTE, \"invitaciones\", idNormalizado);\r\n      \r\n      await deleteDoc(docRef);\r\n      console.log(`‚úÖ Invitaci√≥n con ID ${idNormalizado} eliminada correctamente.`);\r\n      \r\n      // üìå Ya no es necesario actualizar manualmente el estado, `onSnapshot()` lo hace autom√°ticamente\r\n    } catch (error) {\r\n      console.error(\"‚ùå Error al eliminar la invitaci√≥n:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"desing-table\">\r\n      <h2 className=\"table\">Numero Total de invitados:</h2>\r\n\r\n      {/* Tabla con los Totales de Invitados */}\r\n      <table className=\"tabla-invitaciones\">\r\n        <thead>\r\n          <tr>\r\n            <th>Invitados Ni√±os</th>\r\n            <th>Invitados Adultos</th>\r\n            <th>Total Invitados</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + (invitacion.invitadosNi√±os || 0), 0)}</td>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + (invitacion.invitadosAdultos || 0), 0)}</td>\r\n            <td>{invitaciones.reduce((total, invitacion) => total + ((invitacion.invitadosNi√±os || 0) + (invitacion.invitadosAdultos || 0)), 0)}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <h2 className=\"table\">Lista de Invitaciones Guardadas</h2>\r\n      {!CATEGORIA_EVENTO || !NOMBRE_CLIENTE ? (\r\n        <p>‚ö†Ô∏è No hay un evento definido para mostrar las invitaciones.</p>\r\n      ) : (\r\n        <table className=\"tabla-invitaciones2\">\r\n          <thead>\r\n            <tr>\r\n              <th>Nombre</th>\r\n              <th>Adultos</th>\r\n              <th>Ni√±os</th>\r\n              <th>Enlace</th>\r\n              <th>Acciones</th>\r\n              <th>Compartir</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {invitaciones.length > 0 ? (\r\n              invitaciones.map((invitacion) => (\r\n                <tr key={invitacion.id}>\r\n                  <td>{invitacion.nombre}</td>\r\n                  <td>{invitacion.invitadosAdultos}</td>\r\n                  <td>{invitacion.invitadosNi√±os}</td>\r\n                  <td><button onClick={() => setLinkPrevisualizacion(invitacion.link)}>üëÅÔ∏è Ver Invitaci√≥n</button></td>\r\n                  <td><button onClick={() => eliminarInvitacion(invitacion.id)}>‚ùå Eliminar</button></td>\r\n                  <td><button onClick={() => compartirPorWhatsApp(invitacion.link, invitacion.nombre)}>üì± Compartir</button></td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td colSpan=\"5\">No hay invitaciones registradas a√∫n.</td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MostrarInvitaciones;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}